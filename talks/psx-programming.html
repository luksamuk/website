<!DOCTYPE html>
<html lang="en_us">
<head>
<meta charset="utf-8"/>
<title>Retro Game Dev</title>
<meta name="author" content="Lucas S. Vieira"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/serif.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h3><b>Retro Game Dev</b></h3><img src="./psxprog/sony-playstation.png" height=200px><p>Desenvolvendo para o PlayStation em 2024</p><p>Lucas S. Vieira<br/>19 de outubro de 2024</p><p><b>UaiDev Talks 2024</b></p>
</section>
<style>
.container{
display: flex;
}
.col{
flex: 1;
}
</style>
<section>
<section id="slide-orgb8f02ec">
<h2 id="orgb8f02ec">Quem sou eu?</h2>
<div class="container">

<div class="col">
<p style="font-size:0.6em;text-align:left;">
Desenvolvedor na Workalove EdTech
</p>

<p style="font-size:0.6em;text-align:left;">
<b>Interesses:</b> Inteligência  artificial, ciência  cognitiva, filosofia  da mente,
teoria   da   computação,   desenvolvimento  de   linguagens   de   programação,
desenvolvimento de jogos, programação bare-metal
</p>

<div style="font-size:0.6em;text-align:left;">
<p>Co-fundador da Common Lisp Brasil
<br/>
<i class="fa fa-globe" aria-hidden="true"></i><code> lisp.com.br</code>
</p></div>

</div>

<div class="col">


<div id="orgb9d42f8" class="figure">
<p><img src="psxprog/eu.jpg" alt="eu.jpg" width="200" />
</p>
</div>

<div style="font-size:0.6em;text-align:left;">
<i class="fa fa-linkedin" aria-hidden="true"></i><code> luksamuk</code><br/>
<i class="fa fa-globe" aria-hidden="true"></i><code> https://luksamuk.codes/</code><br/>
<i class="fa fa-github" aria-hidden="true"></i><code> luksamuk</code>
</div>

</div>

</div>
</section>
</section>
<section>
<section id="slide-org8c54043">
<h2 id="org8c54043">Roadmap</h2>
<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li>História do PlayStation</li>
<li>Toolchains</li>
<li>Hardware</li>
<li>Gráficos</li>
<li>Exemplos</li>
<li>Homebrews, projetos, cursos</li>

</ul>
</div>

<div class="col">
<img src="./psxprog/ps1-pic.png">
</div>
</div>
</section>
</section>
<section>
<section id="slide-orgaac316b">
<h2 id="orgaac316b">História do PlayStation</h2>
<img class="r-stretch" src="./psxprog/kutaragi-psx.png">

<p style="font-size:0.6em;text-align:center;">
<b>Figura:</b> Ken Kutaragi e o Sony PlayStation
</p>
</section>
<section id="slide-org96e89bb">
<h3 id="org96e89bb">Antes do Super Nintendo&#x2026;</h3>
<img src="./psxprog/s-smp-audio-chip.jpg">
<br/>

<ul style="font-size:0.6em;text-align:left;">
<li><b>Sony:</b> Ken Kutaragi</li>
<li><b>S-SMP:</b> Sound Chip do SNES</li>

</ul>
</section>
<section id="slide-org707f123">
<h3 id="org707f123">Antes do PlayStation&#x2026;</h3>
<div class="container">
<div class="col">
<p style="font-size:0.6em;text-align:left;">
<b>Quarta geração de consoles (1987)</b>
</p>

<ul style="font-size:0.6em;text-align:left;">
<li>Sega Genesis / Sega Mega Drive (1989)</li>
<li>Super Nintendo / Super Famicom (1991)</li>

</ul>
</div>
<div class="col">
<img src="./psxprog/fourthgen.png">
</div>
</div>

<img src="./psxprog/sonic-16.gif">
<img src="./psxprog/mario-16.gif">

</section>
<section id="slide-org707f123-split">

<p style="font-size:0.6em;text-align:center;">
3D  já  era  uma realidade  em  filmes  e  simulações,  e até  em  alguns  jogos
(principalmente em arcades).
</p>

<img src="./psxprog/starfox-16.gif">

<p style="font-size:0.6em;text-align:center;">
<b>Exemplo:</b> StarFox (SNES, 1993)
</p>
</section>
<section id="slide-org8a51d4f">
<h3 id="org8a51d4f">Parceria Sony x Nintendo</h3>
<img src="./psxprog/nintendo-playstation.png">

<ul style="font-size:0.6em;text-align:left;">
<li><b>Nintendo Super Disc / Nintendo Play Station</b></li>
<li>Cartuchos de SNES + CD-ROMs
<ul>
<li>Apenas a Sony poderia produzir os CD-ROMs!</li>

</ul></li>
<li>Nintendo "trai" a Sony e fecha parceria com a Phillips</li>

</ul>
</section>
<section id="slide-org491f1f3">
<h3 id="org491f1f3">Quinta geração de consoles (1993)</h3>
<p style="font-size:0.6em;text-align:left;">
Consoles de 32-bits que introduziam o CD-ROM como mídia física*.
</p>

<p style="font-size:0.6em;text-align:left;">
<b>Objetivo:</b> Colocar milhares de polígonos na tela &#x2013; 3D!
</p>

<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li>Sega Saturn (1994)</li>
<li>Sony PlayStation (1994)</li>
<li>Nintendo 64 (1996)</li>

</ul>
</div>
<div class="col">
<img src="./psxprog/fifthgen.png">
</div>
</div>

<p style="font-size:0.6em;text-align:left;">
*Exceto o Nintendo 64.
</p>

</section>
<section id="slide-org491f1f3-split">

<img src="./psxprog/sonicr-32.gif">
<img src="./psxprog/crash-32.gif">
<img src="./psxprog/zelda-32.gif">

<p style="font-size:0.6em;text-align:center;">
<b>Sonic R</b> (Sega  Saturn), <b>Crash Bandicoot</b> (Sony PlayStation) e  <b>The Legend of
Zelda: Ocarina of Time</b> (Nintendo 64).
</p>
</section>
</section>
<section>
<section id="slide-orga0fc2eb">
<h2 id="orga0fc2eb">Toolchains</h2>
<div class="outline-text-2" id="text-orga0fc2eb">
</div>
</section>
<section id="slide-orgf517bbe">
<h3 id="orgf517bbe">Toolchain legada</h3>
<p style="font-size:0.6em;text-align:center;">
<b>Plataforma:</b> Windows XP / Windows 98
</p>

<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li>Linguagem C</li>
<li>Psy-Q + ccpsx</li>
<li>Editor de sua escolha</li>
<li>Várias ferramentas de apoio (TIMTOOL, MC32, etc)</li>
<li><b>Emulador:</b> no$psx</li>

</ul>
</div>
<div class="col">
<img src="./psxprog/ps1-devkit.jpg">
<p style="font-size:0.6em;text-align:left;">
<b>Figura:</b> Kit de desenvolvimento oficial do PS1.
</p>
</div>
</div>
</section>
<section id="slide-org3b6832d">
<h3 id="org3b6832d">Toolchain nova</h3>
<p style="font-size:0.6em;text-align:center;">
<b>Plataforma:</b> Windows 11 / Linux
</p>

<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li>Linguagem C</li>
<li>Psy-Q + Nugget + GCC-MIPSEL</li>
<li>Extensão PSX.Dev (VSCode)</li>
<li><b>Emulador:</b> pcsx-redux</li>

</ul>
</div>
<div class="col">
<img class="r-stretch" src="./psxprog/vscode.png">
<p style="font-size:0.6em;text-align:left;">
<b>Figura:</b> Dashboard da extensão PSX.Dev para VSCode.
</p>
</div>
</div>
</section>
<section id="slide-org3fdb4a6">
<h3 id="org3fdb4a6">Toolchains alternativas</h3>
<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li><b>PSn00bSDK</b> (C + ASM)</li>
<li>PsyQo + EASTL (C++)</li>
<li>Net Yaroze (oficial, Psy-Q)</li>

</ul>
</div>

<div class="col">
<img src="./psxprog/netyaroze.jpg">
<p style="font-size:0.6em;text-align:left;">
<b>Figura:</b> Sony Net Yaroze + Psy-Q SDK.
</p>
</div>
</div>
</section>
</section>
<section>
<section id="slide-orge6d89f0">
<h2 id="orge6d89f0">Hardware</h2>
<img class="r-stretch" src="./psxprog/psx-motherboard.png">

<p style="font-size:0.6em;text-align:center;">
<b>Figura:</b> Placa-mãe de um PlayStation modelo SCPH-1000.
</p>
</section>
<section id="slide-org3f74bdf">
<h3 id="org3f74bdf">CPU</h3>
<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li>LSI Logic MIPS R3000A 32-bit (RISC) @ 33.86 MHz</li>
<li><b>Co-processadores:</b>
<ul>
<li><b>Cop0:</b> <i>System Control</i> (cache, interrupções&#x2026;)</li>
<li><b>Cop2:</b> <i>Geometry Transformation Engine</i> (GTE)</li>

</ul></li>
<li><b>MDEC:</b> <i>Motion Decoder</i> (DSP para decodificar vídeo)</li>

</ul>

<p style="font-size:0.6em;text-align:left;">
<b>AO LADO:</b> Dieshot do CXD8530Q (primeira revisão), tirado da apresentação do Ken
Kutaragi na Hot Chips '99.
</p>

<p style="font-size:0.6em;text-align:center;">
<b>Fonte:</b> <a href="https://www.psdevwiki.com/ps1/CPU" style="font-size:0.6em;text-align:center;">PlayStation Dev Wiki</a>
</p>
</div>

<div class="col">
<img class="r-stretch" src="./psxprog/cpu-dieshot.jpg">
</div>
</div>


</section>
<section id="slide-org3f74bdf-split">

<p style="font-size:0.6em;text-align:left;">
A  especificação das  CPUs  MIPS  32-bit possuía  um  co-processador <b>Cop1</b>  para
<i>float</i>, e um D-Cache para acesso à RAM.
</p>

<p style="font-size:0.6em;text-align:left;">
<b>O PlayStation 1 não possui nenhum dos dois.</b>
</p>

<p style="font-size:0.6em;text-align:center;">
Solução: <i>fixed-points</i> e <i>scratchpad</i>.
</p>
</section>
<section id="slide-org71fb50b">
<h3 id="org71fb50b">Memória RAM</h3>
<ul style="font-size:0.6em;text-align:left;">
<li>2 MB de memória EDO (Extended Data Out)</li>
<li>Acesso LIVRE (você não terá segmentation faults)
<ul>
<li>Mas pode ter exceções de hardware</li>

</ul></li>

</ul>
</section>
<section id="slide-org8854e4f">
<h4 id="org8854e4f">Mapa de memória</h4>
<p style="font-size:0.6em;text-align:left;">
Como 32-bit podem mapear até 2GB, os endereços que "sobram" no PlayStation foram
utilizados para outros propósitos muito úteis.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" style="font-size:0.6em;">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">KUSEG</th>
<th scope="col" class="org-left">Tamanho</th>
<th scope="col" class="org-left">Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">00000000</td>
<td class="org-left">2048K</td>
<td class="org-left">RAM (primeiros 64K reservados)</td>
</tr>

<tr>
<td class="org-left">1F000000</td>
<td class="org-left">8192K</td>
<td class="org-left">Expansão 1 (ROM/RAM)</td>
</tr>

<tr>
<td class="org-left">1F800000</td>
<td class="org-left">1K</td>
<td class="org-left">Scratchpad</td>
</tr>

<tr>
<td class="org-left">1F801000</td>
<td class="org-left">4K</td>
<td class="org-left">Portas E/S</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left">1FC00000</td>
<td class="org-left">512K</td>
<td class="org-left">BIOS ROM (Kernel)</td>
</tr>
</tbody>
</table>
</section>
<section id="slide-org4fb6830">
<h3 id="org4fb6830">GPU</h3>
<div class="container">
<div class="col">
<ul style="font-size:0.6em;text-align:left;">
<li><b>GPU:</b> SCPH-9000 (Toshiba)
<ul>
<li>Responsável pela rasterização</li>
<li>Apenas rasterização 2D! (mais sobre isso depois)</li>

</ul></li>
<li><b>VRAM:</b> 1 MB</li>

</ul>
</div>

<div class="col">
<img class="r-stretch" src="./psxprog/spider-psx.gif">
<p style="font-size:0.6em;text-align:center;">
<b>Jogo:</b>  Spider-Man  (PSX).   Tente  notar os  artefatos  (<i>polygon  jittering</i>,
 <i>z-fighting</i>, <i>t-junctions</i>&#x2026;)
</p>
</div>
</div>
</section>
<section id="slide-org0ca36b7">
<h3 id="org0ca36b7">Outras estruturas</h3>
<ul style="font-size:0.6em;text-align:left;">
<li><b>SPU</b> (Sound Processing Unit) (Sony)
<ul>
<li>16-bit, estéreo ou mono</li>
<li>Formato ADPCM, 24 canais</li>
<li>Envelope ADSR</li>
<li><b>SRAM:</b> 512 KB DRAM</li>

</ul></li>
<li><b>CD-ROM</b>
<ul>
<li>DSP controlador de motor e laser</li>
<li>Sistema de arquivos ISO 9660 (Yellow Book)</li>
<li>Suporta CD-DA (Red Book), CD-ROM XA</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org7ab9679">
<h2 id="org7ab9679">Gráficos</h2>
<img class="r-stretch" src="./psxprog/psx-graphics-system.png">

<p style="font-size:0.6em;text-align:center;">
<b>Fonte:</b> <a href="https://psx.arthus.net/sdk/Psy-Q/DOCS/Devrefs/Hardware.pdf" style="font-size:0.6em;text-align:center;">PlayStation Hardware Reference</a>
</p>
</section>
<section id="slide-orgf291d90">
<h3 id="orgf291d90">Entendendo o Frame Buffer</h3>
<div class="container">
<div class="col">
<img src="./psxprog/timtool.png">
</div>
<div class="col">
<img src="./psxprog/framebuffer.png">
</div>
</div>

<ul style="font-size:0.6em;text-align:left;">
<li>Color depth: 24bpp, 15bpp ou usando CLUTs (4bpp ou 8bpp).</li>
<li>Dividido em <i>texture pages</i> (TPAGEs).</li>
<li>Comporta o <i>double buffer</i> da tela.</li>
<li>Comporta texturas (tam. máx.: 256x256, precisão de 1 byte)</li>
<li>Polígonos suportam <b><i>gouraud shading</i></b>&#x2026;</li>

</ul>
</section>
<section id="slide-orga95134f">
<h3 id="orga95134f">O que é Gouraud shading?</h3>
<ul style="font-size:0.6em;text-align:left;">
<li>Henri Gouraud, 1971</li>
<li>Interpolação contínua de cores, pode simular luz</li>

</ul>

<div class="container">
<div class="col">
<img src="./psxprog/gouraud-sphere.gif">
<p style="font-size:0.6em;text-align:left;">
Esfera low-poly com reflexão especular.
</p>
</div>
<div class="col">
<img src="./psxprog/banjo.png">
<p style="font-size:0.6em;text-align:left;">
Banjo, personagem de <b>Banjo-Kazooie</b>, como visto no Nintendo 64.
</p>
</div>
</div>
</section>
</section>
<section>
<section id="slide-org4d38c8e">
<h2 id="org4d38c8e">Exemplos de renderização</h2>
<img class="r-stretch" src="./psxprog/psy-q.jpg">

<p style="font-size:0.6em;text-align:left;">
<b>Figura:</b> Detalhe do Psy-Q SDK.
</p>
</section>
<section id="slide-org0a3afce">
<h3 id="org0a3afce">Triângulo Gouraud-shaded (ASM)</h3>
<p style="font-size:0.6em;text-align:left;">
<b>Algumas constantes:</b>
</p>

<div class="org-src-container">

<pre  class="src src-asm"   ><code trim>        <span style="color: #9d81ba;">.psx</span>
        <span style="color: #9d81ba;">.create</span> <span style="color: #f5c791;">"exercicio2.bin"</span>, <span style="color: #f5c791;">0x80010000</span>
        <span style="color: #9d81ba;">.org</span> <span style="color: #f5c791;">0x80010000</span>

        <span style="color: #9d81ba;">IO_BASE_ADDR</span> equ <span style="color: #f5c791;">0x1f80</span> <span style="color: #454459;">; </span><span style="color: #454459;">Endere&#231;o-base (0x1f800000)</span>
        <span style="color: #9d81ba;">GP0</span>          equ <span style="color: #f5c791;">0x1810</span> <span style="color: #454459;">; </span><span style="color: #454459;">Reg. GP0 (GPU) no segm. de E/S</span>
        <span style="color: #9d81ba;">GP1</span>          equ <span style="color: #f5c791;">0x1814</span> <span style="color: #454459;">; </span><span style="color: #454459;">Reg. GP1 (GPU) no segm. de E/S</span>
<span style="color: #0bc9cf;">Main</span>:
        <span style="color: #9d81ba;">lui</span>     $t0, IO_BASE_ADDR
        <span style="color: #454459;">;; </span><span style="color: #454459;">...</span>
</code></pre>
</div>

</section>
<section id="slide-org0a3afce-split">

<div class="org-src-container">

<pre  class="src src-asm"   ><code trim><span style="color: #454459;">;; </span><span style="color: #454459;">Tri&#226;ngulo gouraud-shaded (CC = 30, cores = 0x00BBGGRR)</span>
<span style="color: #0bc9cf;">li</span>      <span style="color: #9d81ba;">$t1</span>, <span style="color: #f5c791;">0x300000ff</span> <span style="color: #454459;">; </span><span style="color: #454459;">30 = POLY_G3. C1: 0x0000ff</span>
<span style="color: #0bc9cf;">sw</span>      <span style="color: #9d81ba;">$t1</span>, GP0($t0)
<span style="color: #0bc9cf;">li</span>      <span style="color: #9d81ba;">$t1</span>, <span style="color: #f5c791;">0x002d00a0</span> <span style="color: #454459;">; </span><span style="color: #454459;">V1: (160, 720) (0x00YYYXXX)</span>
<span style="color: #0bc9cf;">sw</span>      <span style="color: #9d81ba;">$t1</span>, GP0($t0)
<span style="color: #0bc9cf;">li</span>      <span style="color: #9d81ba;">$t1</span>, <span style="color: #f5c791;">0x0000ff00</span> <span style="color: #454459;">; </span><span style="color: #454459;">C2: 0x00ff00</span>
<span style="color: #0bc9cf;">sw</span>      <span style="color: #9d81ba;">$t1</span>, GP0($t0)
<span style="color: #0bc9cf;">li</span>      <span style="color: #9d81ba;">$t1</span>, <span style="color: #f5c791;">0x00bb8050</span> <span style="color: #454459;">; </span><span style="color: #454459;">V2: (80, 3000)</span>
<span style="color: #0bc9cf;">sw</span>      <span style="color: #9d81ba;">$t1</span>, GP0($t0)
<span style="color: #0bc9cf;">li</span>      <span style="color: #9d81ba;">$t1</span>, <span style="color: #f5c791;">0x00ff0000</span> <span style="color: #454459;">; </span><span style="color: #454459;">C3: 0xff0000</span>
<span style="color: #0bc9cf;">sw</span>      <span style="color: #9d81ba;">$t1</span>, GP0($t0)
<span style="color: #0bc9cf;">li</span>      <span style="color: #9d81ba;">$t1</span>, <span style="color: #f5c791;">0x00bb80f0</span> <span style="color: #454459;">; </span><span style="color: #454459;">V3: (240, 3000)</span>
<span style="color: #0bc9cf;">sw</span>      <span style="color: #9d81ba;">$t1</span>, GP0($t0)
</code></pre>
</div>

</section>
<section id="slide-org0a3afce-split">

<img src="./psxprog/gouraudtriangle.png">
</section>
<section id="slide-orgb58c56c">
<h3 id="orgb58c56c">Cubo Gouraud-shaded (Psy-Q / C)</h3>
<p style="font-size:0.6em;text-align:left;">
<b>Passo 1:</b> Definir os vértices e a ordem deles para cada triângulo:
</p>

<div class="container">
<div class="col">

<div class="org-src-container">

<pre  class="src src-c"   ><code trim><span style="color: #454459;">// </span><span style="color: #454459;">NOTA: 64 = 0.015625</span>
<span style="color: #454459;">// </span><span style="color: #454459;">(note que 4096 = 1.0)</span>
<span style="color: #62D2DB;">SVECTOR</span> <span style="color: #7CF083;">vertices</span>[] = {
    { -<span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span> },
    {  <span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span> },
    {  <span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span> },
    { -<span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span> },
    { -<span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span> },
    {  <span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span>, -<span style="color: #f5c791;">64</span> },
    {  <span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span> },
    { -<span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span>,  <span style="color: #f5c791;">64</span> }
};
</code></pre>
</div>

</div>
<div class="col">

<div class="org-src-container">

<pre  class="src src-c"   ><code trim><span style="color: #62D2DB;">short</span> <span style="color: #7CF083;">faces</span>[] = {
    <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">3</span>, <span style="color: #f5c791;">2</span>, <span style="color: #454459;">// </span><span style="color: #454459;">top</span>
    <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">2</span>, <span style="color: #f5c791;">1</span>,
    <span style="color: #f5c791;">4</span>, <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">1</span>, <span style="color: #454459;">// </span><span style="color: #454459;">front</span>
    <span style="color: #f5c791;">4</span>, <span style="color: #f5c791;">1</span>, <span style="color: #f5c791;">5</span>,
    <span style="color: #f5c791;">7</span>, <span style="color: #f5c791;">4</span>, <span style="color: #f5c791;">5</span>, <span style="color: #454459;">// </span><span style="color: #454459;">bottom</span>
    <span style="color: #f5c791;">7</span>, <span style="color: #f5c791;">5</span>, <span style="color: #f5c791;">6</span>,
    <span style="color: #f5c791;">5</span>, <span style="color: #f5c791;">1</span>, <span style="color: #f5c791;">2</span>, <span style="color: #454459;">// </span><span style="color: #454459;">right</span>
    <span style="color: #f5c791;">5</span>, <span style="color: #f5c791;">2</span>, <span style="color: #f5c791;">6</span>,
    <span style="color: #f5c791;">2</span>, <span style="color: #f5c791;">3</span>, <span style="color: #f5c791;">7</span>, <span style="color: #454459;">// </span><span style="color: #454459;">back</span>
    <span style="color: #f5c791;">2</span>, <span style="color: #f5c791;">7</span>, <span style="color: #f5c791;">6</span>,
    <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">4</span>, <span style="color: #f5c791;">7</span>, <span style="color: #454459;">// </span><span style="color: #454459;">left</span>
    <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">7</span>, <span style="color: #f5c791;">3</span>
};
</code></pre>
</div>

</div>
</div>

</section>
<section id="slide-orgb58c56c-split">

<p style="font-size:0.6em;text-align:left;">
<b>Passo 2:</b> Popular a matriz do mundo com rotação, translação e escala
</p>

<div class="org-src-container">

<pre  class="src src-c"   ><code trim><span style="color: #9d81ba;">static</span> <span style="color: #62D2DB;">SVECTOR</span> <span style="color: #7CF083;">rotation</span>    = {<span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">0</span>};   <span style="color: #454459;">// </span><span style="color: #454459;">manipulado via c&#243;digo</span>
<span style="color: #9d81ba;">static</span> <span style="color: #62D2DB;">VECTOR</span>  <span style="color: #7CF083;">translation</span> = {<span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">700</span>}; <span style="color: #454459;">// </span><span style="color: #454459;">0.4375</span>
<span style="color: #9d81ba;">static</span> <span style="color: #62D2DB;">VECTOR</span>  <span style="color: #7CF083;">scale</span>       = {ONE, ONE, ONE};
<span style="color: #9d81ba;">static</span> <span style="color: #62D2DB;">MATRIX</span>  <span style="color: #7CF083;">world</span>       = {<span style="color: #f5c791;">0</span>};

<span style="color: #454459;">// </span><span style="color: #454459;">Populate world matrix with rotation, translation,</span>
<span style="color: #454459;">// </span><span style="color: #454459;">scale values</span>
RotMatrix(&amp;rotation, &amp;world);
TransMatrix(&amp;world, &amp;translation);
ScaleMatrix(&amp;world, &amp;scale);

<span style="color: #454459;">// </span><span style="color: #454459;">Sets world matrix to be used by the GTE for rotation</span>
<span style="color: #454459;">// </span><span style="color: #454459;">and translation</span>
SetRotMatrix(&amp;world);
SetTransMatrix(&amp;world);
</code></pre>
</div>

</section>
<section id="slide-orgb58c56c-split">

<p style="font-size:0.6em;text-align:left;">
<b>Passo 3:</b>  Para cada triângulo,  transformar seus vértices e  transformá-los em
pontos 2D:
</p>

<div class="container">
<div class="col">

<div class="org-src-container">

<pre  class="src src-c"   ><code trim><span style="color: #9d81ba;">for</span>(i = <span style="color: #f5c791;">0</span>; i &lt; NUM_FACES * <span style="color: #f5c791;">3</span>; i += <span style="color: #f5c791;">3</span>) {
    <span style="color: #62D2DB;">POLY_G3</span> *<span style="color: #7CF083;">poly</span> = (<span style="color: #62D2DB;">POLY_G3</span>*)nextprim;
    setPolyG3(poly);
    setRGB0(poly, <span style="color: #f5c791;">255</span>, <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">255</span>);
    setRGB1(poly, <span style="color: #f5c791;">255</span>, <span style="color: #f5c791;">255</span>, <span style="color: #f5c791;">0</span>);
    setRGB2(poly, <span style="color: #f5c791;">0</span>, <span style="color: #f5c791;">255</span>, <span style="color: #f5c791;">255</span>);
    nclip = RotAverageNclip3(
        &amp;vertices[faces[i + <span style="color: #f5c791;">0</span>]],
        &amp;vertices[faces[i + <span style="color: #f5c791;">1</span>]],
        &amp;vertices[faces[i + <span style="color: #f5c791;">2</span>]],
        (<span style="color: #62D2DB;">long</span>*)&amp;poly-&gt;x0,
        (<span style="color: #62D2DB;">long</span>*)&amp;poly-&gt;x1,
        (<span style="color: #62D2DB;">long</span>*)&amp;poly-&gt;x2,
        &amp;p, &amp;otz, &amp;flg);
    <span style="color: #454459;">// </span><span style="color: #454459;">...</span>
}
</code></pre>
</div>

</div>
<div class="col">

<div class="org-src-container">

<pre  class="src src-c"   ><code trim><span style="color: #454459;">// </span><span style="color: #454459;">Extra&#237;do do SDK</span>
<span style="color: #9d81ba;">typedef</span> <span style="color: #9d81ba;">struct</span> {
    <span style="color: #62D2DB;">u_long</span> <span style="color: #7CF083;">tag</span>;
    <span style="color: #62D2DB;">u_char</span> <span style="color: #7CF083;">r0</span>, <span style="color: #7CF083;">g0</span>, <span style="color: #7CF083;">b0</span>, <span style="color: #7CF083;">code</span>;
    <span style="color: #62D2DB;">short</span>  <span style="color: #7CF083;">x0</span>,     <span style="color: #7CF083;">y0</span>;
    <span style="color: #62D2DB;">u_char</span> <span style="color: #7CF083;">r1</span>, <span style="color: #7CF083;">g1</span>, <span style="color: #7CF083;">b1</span>, <span style="color: #7CF083;">pad1</span>;
    <span style="color: #62D2DB;">short</span>  <span style="color: #7CF083;">x1</span>,     <span style="color: #7CF083;">y1</span>;
    <span style="color: #62D2DB;">u_char</span> <span style="color: #7CF083;">r2</span>, <span style="color: #7CF083;">g2</span>, <span style="color: #7CF083;">b2</span>, <span style="color: #7CF083;">pad2</span>;
    <span style="color: #62D2DB;">short</span>  <span style="color: #7CF083;">x2</span>,     <span style="color: #7CF083;">y2</span>;
} <span style="color: #62D2DB;">POLY_G3</span>; <span style="color: #454459;">/* </span><span style="color: #454459;">Gouraud Triangle</span><span style="color: #454459;"> */</span>
</code></pre>
</div>

</div>
</div>

</section>
<section id="slide-orgb58c56c-split">

<p style="font-size:0.6em;text-align:left;">
<b>Passo  4:</b> Verificar  se  a primitiva  deveria estar  sendo  desenhada na  tela
(<i>normal clipping</i>) e colocá-la na <i>ordering table</i> (lista de primitivas):
</p>

<div class="org-src-container">

<pre  class="src src-c"   ><code trim><span style="color: #9d81ba;">for</span>(i = <span style="color: #f5c791;">0</span>; i &lt; NUM_FACES * <span style="color: #f5c791;">3</span>; i += <span style="color: #f5c791;">3</span>) {
    <span style="color: #454459;">// </span><span style="color: #454459;">...</span>
    <span style="color: #9d81ba;">if</span>(nclip &lt;= <span style="color: #f5c791;">0</span>) <span style="color: #9d81ba;">continue</span>;

    <span style="color: #9d81ba;">if</span>((otz &gt; <span style="color: #f5c791;">0</span>) &amp;&amp; (otz &lt; OT_LENGTH)) {
        addPrim(ot[currbuff][otz], poly);
        nextprim += <span style="color: #9d81ba;">sizeof</span>(POLY_G3);
    }
}
</code></pre>
</div>

</section>
<section id="slide-orgb58c56c-split">

<p style="font-size:0.6em;text-align:left;">
<b>Passo  5:</b> Esperar  vsync;  desenhar quadro  anterior;  realizar <i>sorting</i>  dos
polígonos.
</p>

<div class="container">
<div class="col">

<div class="org-src-container">

<pre  class="src src-c"   ><code trim>DrawSync(<span style="color: #f5c791;">0</span>);
VSync(<span style="color: #f5c791;">0</span>);

PutDispEnv(
    &amp;screen.disp[currbuff]);
PutDrawEnv(
    &amp;screen.draw[currbuff]);

<span style="color: #0bc9cf;">DrawOTag</span>(
    <span style="color: #62D2DB;">ot</span>[currbuff] +
    OT_LENGTH - <span style="color: #f5c791;">1</span>);
</code></pre>
</div>

</div>

<div class="col">
<img src="./psxprog/gouraudcube.gif">
</div>
</div>
</section>
</section>
<section>
<section id="slide-org6741ff6">
<h2 id="org6741ff6">Homebrews</h2>
<p style="font-size:0.6em;text-align:center;">
Pequenos projetos que desenvolvi usando este aprendizado.
</p>
</section>
<section id="slide-orgfc4919b">
<h3 id="orgfc4919b">Wipefaux</h3>
<div class="container">
<div class="col">
<img class="r-stretch" src="./psxprog/wipefaux.gif">
</div>
<div class="col">
<p style="font-size:0.6em;text-align:center;">
Clone parcial  do jogo  WipEout. Desenvolvido durante  o curso  <i>PS1 Programming
with MIPS Assembly &amp; C</i>.
</p>
</div>
</div>

<p style="font-size:0.75em;text-align:center;">
<a href="https://luksamuk.codes/static/psx/?game=wipefaux" style="font-size:0.75em;text-align:center;">https://luksamuk.codes/static/psx/?game=wipefaux</a>
</p>
</section>
<section id="slide-org94a3065">
<h3 id="org94a3065">Sonic XA (<code>engine-psx</code>)</h3>
<div class="container">
<div class="col">
<img class="r-stretch" src="./psxprog/engine-psx.gif">
</div>
<div class="col">
<img class="r-stretch" src="./psxprog/engine-psx-title.png">
</div>
</div>

<p style="font-size:0.6em;text-align:center;">
Fan-game de  Sonic The Hedgehog  utilizando técnicas  do hardware do  PSX (áudio
CD-XA, FMVs via MDEC, etc.)
</p>

<p style="font-size:0.75em;text-align:center;">
<a href="https://github.com/luksamuk/engine-psx" style="font-size:0.75em;text-align:center;">https://github.com/luksamuk/engine-psx</a>
</p>
</section>
<section id="slide-orgeca6240">
<h3 id="orgeca6240">Comunidades e Cursos</h3>
<ul style="font-size:0.6em;text-align:left;">
<li>Pikuma.com: <a href="https://pikuma.com/courses/ps1-programming-mips-assembly-language">PS1 Programming with MIPS Assembly &amp; C</a></li>
<li><a href="https://www.psxdev.net/">PSXDEV Network</a></li>
<li><a href="https://psx-spx.consoledev.net/">PlayStation Specifications (<code>psx-spx</code>)</a></li>

</ul>
</section>
</section>
<section>
<section id="slide-org5372cf6">
<h2 id="org5372cf6">Obrigado!</h2>
<img class="r-stretch" src="./psxprog/ps1-logo.png">
<br/>

<div style="font-size:0.6em;text-align:center;">
<i class="fa fa-envelope" aria-hidden="true"></i><code> lucasvieira@protonmail.com</code><br/>
<i class="fa fa-linkedin" aria-hidden="true"></i><code> luksamuk</code><br/>
<i class="fa fa-globe" aria-hidden="true"></i><code> https://luksamuk.codes/</code><br/>
<i class="fa fa-github" aria-hidden="true"></i><code> luksamuk</code>
</div>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
slideNumber:true,

// Optional libraries used to extend on reveal.js
dependencies: [
,
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } }]

});

</script>
</body>
</html>
