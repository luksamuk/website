<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US" xml:lang="en_US">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Revisiting Windows 98's nostalgia</title>
<meta name="author" content="Lucas S. Vieira" />
<meta name="description" content="Programming, Tech, and occasional rant space by Lucas Vieira" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-22RF3F5XE0"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-22RF3F5XE0');
</script>
<link rel="stylesheet" type="text/css" href="../css/main.css" />
<link rel="stylesheet" type="text/css" href="../css/syntax.css" />
<link id="theme-css" rel="stylesheet" type="text/css" href="../css/dark-theme.css" />
<link rel="icon" type="image/jpg" href="../img/cat-i-mage.jpg" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:image" content="../img/cat-i-mage.jpg">
<meta name="theme-color" content="#14171e">
</head>
<body>
<div id="preamble" class="status">
<nav><h1><a href="../">The Alchemist's Hideout</a></h1></nav><h1 class="title">Revisiting Windows 98's nostalgia</h1><p><i>Written in Apr 01, 2024 by Lucas S. Vieira<br/><a href="mailto:lucasvieira@protonmail.com">lucasvieira@protonmail.com</a></i></p>
</div>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc4e6048">A little nostalgic introduction&#x2026;</a></li>
<li><a href="#org5bd88eb">Preparation</a>
<ul>
<li><a href="#org985803d">Creating an ISO file</a></li>
</ul>
</li>
<li><a href="#org5705573">Installing Windows 98</a>
<ul>
<li><a href="#org90cae29">Creating the virtual machine</a></li>
<li><a href="#org10facd4">Configuring hard drive and beginning the installation</a></li>
<li><a href="#org6259682">Finishing the installation</a></li>
</ul>
</li>
<li><a href="#org7bd1e76">Extending available memory up to 4GB of RAM</a></li>
<li><a href="#org858676a">Installing a video driver</a>
<ul>
<li><a href="#org2816bb4">Improving graphics</a></li>
</ul>
</li>
<li><a href="#orgd0488c3">Fixing MS-DOS Prompt memory error</a></li>
<li><a href="#orgffe008c">Installing KernelEx to allow some forward compatibility</a></li>
<li><a href="#org452d5ad">Updating Internet Explorer to IE6</a></li>
<li><a href="#org96a4d74">Extras</a>
<ul>
<li><a href="#org042e803">Essential programs</a>
<ul>
<li><a href="#orgbf6dad2">RetroZilla</a></li>
<li><a href="#orgc39f186">Winamp</a></li>
<li><a href="#orgf0f77d0">Adobe Reader 6.0</a></li>
<li><a href="#orgd7f18d8">7-Zip 4.65</a></li>
</ul>
</li>
<li><a href="#org86ceb5e">Development</a>
<ul>
<li><a href="#org282af70">Visual Studio 6</a></li>
</ul>
</li>
<li><a href="#org3f66dd7">Other useful tools</a>
<ul>
<li><a href="#org63e5948">FileZilla Client</a></li>
<li><a href="#org99829b8">Process Explorer</a></li>
<li><a href="#orgd2d234d">AutoPatcher for Win98SE</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="orgf4df8c3" class="figure">
<p><img src="./win98/win98.jpg" alt="win98.jpg" width="500" />
</p>
</div>

<p>
<span class="underline">DISCLAIMER: I started  writing this article a few months  ago. So I'm uploading
it in 2024. Sorry about that. :P</span>
</p>
<div id="outline-container-orgc4e6048" class="outline-2">
<h2 id="orgc4e6048">A little nostalgic introduction&#x2026;</h2>
<div class="outline-text-2" id="text-orgc4e6048">
<p>
The other day,  I was struck by  nostalgia. After having to deal,  at work, with
the fact that  Windows 7 is now  discontinued, I was thinking about  how some of
the old Microsoft OSes were good and simply just worked.
</p>

<p>
I was  just a kid when  I got my first  computer. My father had  bought it circa
2002,  and it  was the  best  computer available  in  Brazil at  the time,  with
incredible  specs (which  I made  sure to  boast while  talking about  it to  my
friends) of  512MB of RAM,  a 9GB  Hard Disk, 32x  CD-ROM drive, and  a glorious
Intel Pentium  III processor  running at  amazing 800MHz. Oh,  and it  came with
Windows 98, Second Edition, in Brazillian Portuguese.
</p>

<p>
I think that at that time, it was already the dawn of Windows XP, since Windows
98 was already four years old, but I remember looking at Windows XP and thinking
all those colors were ugly. The system  was indeed very fast and capable, and as
a kid I was worried that newer games were  not going to run on 98 very soon, but
something about 98's minimal looks always made it enjoyable to me.
</p>

<p>
Thinking in retrospect, after Windows 7, things got really really weird. I don't
think that operating systems should come out-of-the-box with so many ads, online
interactions  and intrusive  stuff  such  as insisting  on  using very  specific
default browsers (I'm looking at you, Edge).
</p>

<p>
So I wanted to experiment again with what  Windows 98 has taught me. I decided I
was going to install it on a virtual machine and do my best to make it usable in
2024, especially if  I could do some  programming on it. I recall  that the last
time I tried  I failed miserably, but  that wouldn't happen this time  &#x2013; and it
didn't.
</p>

<p>
The  following bits  are  a structured  version of  my  notes after  configuring
Windows  98  on  VirtualBox.  Make  sure you  get  everything  you  need  before
starting. And if you happen to find stuff  you want to install but isn't here, I
recommend  either creating  an  ISO  containing your  files  with <code>mkisofs</code>,  or
setting  up an  FTP  server you  can  connect to  by using  the  old version  of
FileZilla that runs on W98.
</p>
</div>
</div>
<div id="outline-container-org5bd88eb" class="outline-2">
<h2 id="org5bd88eb">Preparation</h2>
<div class="outline-text-2" id="text-org5bd88eb">
<p>
You'll  need a  few things  along the  way. These  are necessary  for a  minimal
experience:
</p>

<ul class="org-ul">
<li>VirtualBox (an updated version is enough);</li>
<li>A Windows 98 Second Edition ISO. <a href="https://archive.org/details/Windows98SE_201906">I am using a Brazillian Portuguese ISO</a>. It is
not an unaltered copy, but it was the best I found since I wanted a Brazillian
Portuguese system.</li>
<li><a href="https://retrorevive.enochdew.com/4gb-ram-windows-98/">A patch for allowing up to 4GB of RAM on Windows 98</a>.</li>
<li><a href="https://documents.upperswanley.com/Don/scitech-display-doctor-7.iso">SciTech Display Doctor  video driver</a>, as explained on <a href="https://forums.virtualbox.org/viewtopic.php?f=28&amp;t=9918">this  post</a> on VirtualBox
forums.  This   is  an   abandonware  ISO  containing   the  driver.</li>
<li><a href="https://archive.org/details/directx_9c">DirectX 9.0c Redistributable</a>.</li>
<li><a href="https://archive.org/details/msfn-archived-topics-june-2021.-7z_202106">KernelEx 4.5.2 and unicows.exe</a>, for  forward compatibility with newer versions
of Windows.</li>
<li><a href="https://archive.org/details/ie-6-ptbr">Internet Explorer 6 installer (Brazillian Portuguese)</a></li>
<li>(OPTIONAL) <a href="https://www.vogons.org/viewtopic.php?t=14934">AutoPatcher for Windows 98 SE</a>. <b><b>I did not use this</b></b> since it kind
of messes up my  language settings on the computer, but it  is probably a good
thing to use if you want a safer system with latest patches.</li>
</ul>

<p>
Notice that most of  these software can be found on the  <a href="https://archive.org">Internet Archive</a>, so if
you're not seeing something in your  desired version or language, you can always
download  abandonware from  the archive  for  free &#x2013;  some are  even posted  by
Microsoft themselves!
</p>
</div>
<div id="outline-container-org985803d" class="outline-3">
<h3 id="org985803d">Creating an ISO file</h3>
<div class="outline-text-3" id="text-org985803d">
<p>
Whenever you want to create an ISO  file, you can use <code>mkisofs</code>, if you're using
Linux like me. Suppose you have a directory called <code>util</code> with all the stuff you
need to use. Here is how you'd create an <code>util.iso</code> file from that directory:
</p>

<div class="org-src-container">
<pre class="src src-bash">mkisofs -lJR -o util.iso util
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5705573" class="outline-2">
<h2 id="org5705573">Installing Windows 98</h2>
<div class="outline-text-2" id="text-org5705573">
</div>
<div id="outline-container-org90cae29" class="outline-3">
<h3 id="org90cae29">Creating the virtual machine</h3>
<div class="outline-text-3" id="text-org90cae29">
<p>
First of all, create a new virtual  machine on VirtualBox. It should be labelled
as a Windows 98.
</p>


<div id="org5c3aaf3" class="figure">
<p><img src="./win98/001.png" alt="001.png" width="500" />
</p>
</div>

<p>
Use a maximum of  1024MB for RAM. This should be enough for  now. We'll raise it
to 4096MB afterwards.
</p>


<div id="org6c1bf8a" class="figure">
<p><img src="./win98/002.png" alt="002.png" width="500" />
</p>
</div>

<p>
For hard disk capacity, 10GB should be enough.
</p>


<div id="org152dbba" class="figure">
<p><img src="./win98/003.png" alt="003.png" width="500" />
</p>
</div>

<p>
Here is a summary of the configuration:
</p>


<div id="org83022d5" class="figure">
<p><img src="./win98/004.png" alt="004.png" width="500" />
</p>
</div>

<p>
Now boot your VM.
</p>
</div>
</div>
<div id="outline-container-org10facd4" class="outline-3">
<h3 id="org10facd4">Configuring hard drive and beginning the installation</h3>
<div class="outline-text-3" id="text-org10facd4">

<div id="org76e55df" class="figure">
<p><img src="./win98/005.png" alt="005.png" width="500" />
</p>
</div>

<p>
Again, in my case,  I'm using a Portuguese ISO, so pick up the
option to boot from CD.
</p>


<div id="orgb733744" class="figure">
<p><img src="./win98/006.png" alt="006.png" width="500" />
</p>
</div>

<p>
Run the installer from the first option.
</p>


<div id="orgb0d37c2" class="figure">
<p><img src="./win98/007.png" alt="007.png" width="500" />
</p>
</div>


<div id="org0f5aae6" class="figure">
<p><img src="./win98/008.png" alt="008.png" width="500" />
</p>
</div>

<p>
Now configure the unallocated space on your virtual hard drive.
Make sure you activate support for large storage disks.
</p>


<div id="org7853e14" class="figure">
<p><img src="./win98/009.png" alt="009.png" width="500" />
</p>
</div>


<div id="orgfd41245" class="figure">
<p><img src="./win98/010.png" alt="010.png" width="500" />
</p>
</div>

<p>
You should have to  reboot and enter the CD installation  again. Then follow the
installation instructions,  and you  should see some prompts like the following.
</p>


<div id="orge0fcf23" class="figure">
<p><img src="./win98/011.png" alt="011.png" width="500" />
</p>
</div>

<p>
Skip through them, and at some point you'll end up at the graphical installer.
</p>


<div id="org4e846de" class="figure">
<p><img src="./win98/012.png" alt="012.png" width="500" />
</p>
</div>

<p>
At this point, I generally select a  personalized setup so that I can enable all
features, including extra languages.
</p>


<div id="org282f3e2" class="figure">
<p><img src="./win98/013.png" alt="013.png" width="500" />
</p>
</div>

<p>
On  keyboard layout,  if you're  installing  a Brazillian  Portuguese system,  I
recommend using the Português (Brasil ABNT2) keyboard.
</p>


<div id="orgf00fa3a" class="figure">
<p><img src="./win98/014.png" alt="014.png" width="500" />
</p>
</div>

<p>
Now everything should be straightforward.
</p>

<p>
At some  point you should be  prompted to insert a  valid CD key. Most  links to
Windows 98 <code>.iso</code> files should be provided along with valid CD keys. This is the
case for the Brazillian Portuguese <code>.iso</code> I am using.
</p>
</div>
</div>
<div id="outline-container-org6259682" class="outline-3">
<h3 id="org6259682">Finishing the installation</h3>
<div class="outline-text-3" id="text-org6259682">
<p>
Go on with  the installation and reboot  a few times; this time,  boot from your
hard disk instead of the CD. You should be able to log in.
</p>


<div id="org4767670" class="figure">
<p><img src="./win98/015.png" alt="015.png" width="500" />
</p>
</div>


<div id="org3ffdc83" class="figure">
<p><img src="./win98/016.png" alt="016.png" width="500" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org7bd1e76" class="outline-2">
<h2 id="org7bd1e76">Extending available memory up to 4GB of RAM</h2>
<div class="outline-text-2" id="text-org7bd1e76">
<p>
Now  let's allow  up to  4GB of  RAM on  our Windows  98 machine.  Go ahead  and
download the  4GB Patch I  mentioned earlier. I  recommend creating an  ISO with
<code>mkisofs</code> and mounting it on the VM.
</p>

<p>
The files are already disposed on the hierarchy they are supposed to be on <code>C:\</code>
drive, so  you should just  copy the files  to their desired  location. However,
<b>make sure you rename the files that  are being replaced</b>, in case anything goes
wrong.
</p>

<p>
In case some  files are apparently missing,  on Windows Explorer, go  to <code>Show &gt;
Folder Options</code>, then allow hidden files to be viewed.
</p>


<div id="orged4f62c" class="figure">
<p><img src="./win98/017.png" alt="017.png" width="500" />
</p>
</div>

<p>
After finishing,  turn off  the virtual  machine. Go  back to  VirtualBox, right
click the virtual machine and go to Settings. On the System section, go ahead to
the slider called Base Memory and set it to 4096MB.
</p>


<div id="org4626411" class="figure">
<p><img src="./win98/018.png" alt="018.png" width="500" />
</p>
</div>

<p>
Start your virtual  machine once again. It  is possible that an  error occurs on
the first boot; if that happens, just turn of the machine and turn it on again.
</p>

<p>
Finally, right  click on <code>My  Computer</code> and go  to <code>Properties</code>. You  should see
that your virtual machine now has close to 4GB of RAM installed.
</p>


<div id="orga54e9c4" class="figure">
<p><img src="./win98/019.png" alt="019.png" width="500" />
</p>
</div>
</div>
</div>
<div id="outline-container-org858676a" class="outline-2">
<h2 id="org858676a">Installing a video driver</h2>
<div class="outline-text-2" id="text-org858676a">
<p>
Firstly, turn off your VM, right click it on VirtualBox, then go to Settings. On
the  Display  tab,   set  Video  Memory  to  128MB,  and   activate  "Enable  3D
Acceleration".
</p>


<div id="org695e69f" class="figure">
<p><img src="./win98/020.png" alt="020.png" width="500" />
</p>
</div>

<p>
Boot the  virtual machine and  <b>mount the ISO  for SciTech Display  Driver</b>. You
should be  able to run the  installer from <code>D:\</code>  driver and you'll also  find a
text file containing the activation, which will be needed later.
</p>


<div id="orgbdc41b6" class="figure">
<p><img src="./win98/021.png" alt="021.png" width="500" />
</p>
</div>

<p>
Do an express installation and, at the end, allow it to reboot your computer.
</p>

<p>
On boot, you should see the  following screen for SciTech Display Doctor. Scroll
down, select Register Now, and use the credentials on the text file on the disc.
</p>


<div id="org237be15" class="figure">
<p><img src="./win98/022.png" alt="022.png" width="500" />
</p>
</div>

<p>
You'll be prompted to reboot at the end;  do it again. Once you do, on the video
driver's dashboard,  select "Monitor not selected"  and, on the new  screen that
opens, select a proper Super VGA resolution.
</p>


<div id="org1232141" class="figure">
<p><img src="./win98/023.png" alt="023.png" width="500" />
</p>
</div>


<div id="org880e6e1" class="figure">
<p><img src="./win98/024.png" alt="024.png" width="500" />
</p>
</div>

<p>
Reboot Windows again and you'll see that the monitor was selected.
</p>

<p>
Now  click the  "Disabled"  link beside  "SciTech Display  Driver".  On the  new
screen, select SciTech Nucleus Driver. Apply and reboot again.
</p>


<div id="org54d9c97" class="figure">
<p><img src="./win98/025.png" alt="025.png" width="500" />
</p>
</div>



<div id="orgdab013a" class="figure">
<p><img src="./win98/026.png" alt="026.png" width="500" />
</p>
</div>

<p>
Now you'll see  that the Graphics Adapter for VirtualBox  is properly recognized
on the dashboard.
</p>


<div id="org0435d4e" class="figure">
<p><img src="./win98/027.png" alt="027.png" width="500" />
</p>
</div>

<p>
Now,  right  click  on  the  desktop  and select  Properties,  then  go  to  the
Configuration tab. On Colors, select High Color (16 bits), then click OK.
</p>


<div id="org59bf092" class="figure">
<p><img src="./win98/028.png" alt="028.png" width="500" />
</p>
</div>

<p>
You'll be prompted to reboot once more. The reboot may hang; allow it to be like
that for a few seconds, then force a reboot through VirtualBox.  If Windows asks
whether you want to boot on Safe Boot, just pick Normal Boot.
</p>

<p>
Once again, right click the Desktop and go to properties. Now you should be able
to select  True Color  (32 bit)  mode, and  a proper  resolution &#x2013;  I'm picking
1024x768.
</p>


<div id="orgfcf8d60" class="figure">
<p><img src="./win98/029.png" alt="029.png" width="500" />
</p>
</div>

<p>
Now your desktop works with proper colors and a proper resolution!
</p>


<div id="org32e7c0a" class="figure">
<p><img src="./win98/030.png" alt="030.png" width="500" />
</p>
</div>
</div>
<div id="outline-container-org2816bb4" class="outline-3">
<h3 id="org2816bb4">Improving graphics</h3>
<div class="outline-text-3" id="text-org2816bb4">
<p>
Your system  is now OK  for running most  graphical applications, however  it is
still not enough if you really want graphics.
</p>

<p>
If you  want DirectX 9 and  proper OpenGL 2.1 support,  you'll need to do  a few
things:
</p>

<ol class="org-ol">
<li>Install <b>DirectX 9.0c Redistributable</b> for  DirectX support. It will give you
access to tools you'd need such as <code>dxdiag</code> .</li>
<li>Download the  <a href="https://retrosystemsrevival.blogspot.com/2020/04/opengl-21-win95.html">MESA 7.5.1 OpenGL 2.1 implementation for  Win32</a>. This will give
you  a better  implementation of  OpenGL than  the one  that SciTech  Display
Driver can  give you.  To use  it, extract the  contents of  the zip  file in
<code>C:\Windows\System</code> (I recommend renaming the old <code>OPENGL32.DLL</code> before doing
that!).</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgd0488c3" class="outline-2">
<h2 id="orgd0488c3">Fixing MS-DOS Prompt memory error</h2>
<div class="outline-text-2" id="text-orgd0488c3">
<p>
Now that we have a video driver  installed, we might have problems while running
applications such as the MS-DOS Prompt, for example.
</p>


<div id="org5fbb93a" class="figure">
<p><img src="./win98/031.png" alt="031.png" width="500" />
</p>
</div>

<p>
This   is   an   easy   fix,   but    not   an   obvious   one.   According   to
<a href="https://www.windowsbbs.com/threads/not-enough-memory-error-when-trying-to-run-a-dos-program-in-a-window.37148/#post-197188">one of the answers on a forum</a>, it's a vcache issue.
</p>

<p>
Go to  <code>Start &gt;  Execute</code>, and  type <code>System.ini</code>, then  press Enter.  You'll be
presented with an <code>.ini</code> file on Notepad.
</p>

<p>
Find the  <code>[vcache]</code> section and  add the new line,  like the example  below (do
not just replace the entire section if there's something already there!):
</p>

<pre class="example" id="org889860d">
[vcache]
MaxFileCache=512000
</pre>

<p>
Save the file, exit and reboot. You should  now be able to run the MS-DOS Prompt
with no further problems.
</p>


<div id="orgeb433bb" class="figure">
<p><img src="./win98/032.png" alt="032.png" width="500" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgffe008c" class="outline-2">
<h2 id="orgffe008c">Installing KernelEx to allow some forward compatibility</h2>
<div class="outline-text-2" id="text-orgffe008c">
<p>
Some programs will simply  not run on Windows 98, period.  But sometimes you can
force them to  run like newer versions of Windows  through a compatibility layer
called KernelEx.
</p>

<p>
First, run the  installation for <code>unicows.exe</code> and, when prompted  to an extract
location, use <code>C:\Windows\System</code> (Note that <b>this is not System32!</b>).
</p>

<p>
Afterwards, run  the KernelEx installation.  Enable KernelEx extensions  for all
applications and, when prompted to reboot, do it.
</p>


<div id="orge6e274b" class="figure">
<p><img src="./win98/033.png" alt="033.png" width="500" />
</p>
</div>

<p>
You  should now  be able  to  right click  any  application or  shortcut, go  to
Properties,  and then  you'll see  a KernelEx  tab where  you can  configure the
kernel to act like some newer versions of Windows.
</p>


<div id="org651fee3" class="figure">
<p><img src="./win98/034.png" alt="034.png" width="500" />
</p>
</div>
</div>
</div>
<div id="outline-container-org452d5ad" class="outline-2">
<h2 id="org452d5ad">Updating Internet Explorer to IE6</h2>
<div class="outline-text-2" id="text-org452d5ad">
<p>
At this point, run the installer for  Internet Explorer 6. It should extract all
installer files and then execute the setup.
</p>


<div id="orgf62f0e2" class="figure">
<p><img src="./win98/035.png" alt="035.png" width="500" />
</p>
</div>

<p>
This process  will update  Internet Explorer, Windows  Media Player  and Outlook
Express.
</p>

<p>
<b>Notice  that  the   installer  will  automatically  reboot   the  system  after
 installation!</b>
</p>
</div>
</div>
<div id="outline-container-org96a4d74" class="outline-2">
<h2 id="org96a4d74">Extras</h2>
<div class="outline-text-2" id="text-org96a4d74">
<p>
Some of the following programs are stuff I installed for enjoying the system.
</p>
</div>
<div id="outline-container-org042e803" class="outline-3">
<h3 id="org042e803">Essential programs</h3>
<div class="outline-text-3" id="text-org042e803">
<p>
These are programs I consider essential for any basic workflow.
</p>
</div>
<div id="outline-container-orgbf6dad2" class="outline-4">
<h4 id="orgbf6dad2">RetroZilla</h4>
<div class="outline-text-4" id="text-orgbf6dad2">

<div id="org12bee92" class="figure">
<p><img src="./win98/retrozilla.png" alt="retrozilla.png" width="500" />
</p>
</div>

<p>
You can only do proper web browsing and e-mail with this. Nuff said.
</p>

<p>
I tested  it with my Google  account as well &#x2013;  though you need a  password for
insecure apps, it works like a charm.
</p>

<p>
<a href="https://rn10950.github.io/RetroZillaWeb/">https://rn10950.github.io/RetroZillaWeb/</a>
</p>
</div>
</div>
<div id="outline-container-orgc39f186" class="outline-4">
<h4 id="orgc39f186">Winamp</h4>
<div class="outline-text-4" id="text-orgc39f186">

<div id="orgafb629f" class="figure">
<p><img src="./win98/winamp.jpg" alt="winamp.jpg" width="500" />
</p>
</div>

<p>
Probably the best music player of all time&#x2026; back then.
</p>

<p>
I'm using  version 5.33,  and I  suppose this was  the last  version to  work on
Windows 98.
</p>

<p>
<a href="http://www.oldversion.com/windows/winamp-5-33-full">http://www.oldversion.com/windows/winamp-5-33-full</a>
</p>
</div>
</div>
<div id="outline-container-orgf0f77d0" class="outline-4">
<h4 id="orgf0f77d0">Adobe Reader 6.0</h4>
<div class="outline-text-4" id="text-orgf0f77d0">

<div id="orgfe871db" class="figure">
<p><img src="./win98/adobe-reader-6.png" alt="adobe-reader-6.png" width="500" />
</p>
</div>

<p>
By far the best (and maybe the only) PDF reader for Windows 98.
</p>

<p>
<a href="https://archive.org/details/AdobeReaderArchives6x11x">https://archive.org/details/AdobeReaderArchives6x11x</a>
</p>
</div>
</div>
<div id="outline-container-orgd7f18d8" class="outline-4">
<h4 id="orgd7f18d8">7-Zip 4.65</h4>
<div class="outline-text-4" id="text-orgd7f18d8">
<p>
You'll certainly need this to deal with compressed files.
</p>

<p>
<a href="https://archive.org/details/7-zip4.65WindowsInstaller">https://archive.org/details/7-zip4.65WindowsInstaller</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org86ceb5e" class="outline-3">
<h3 id="org86ceb5e">Development</h3>
<div class="outline-text-3" id="text-org86ceb5e">
<p>
These are some of the tools I used for development on Windows 98.
</p>
</div>
<div id="outline-container-org282af70" class="outline-4">
<h4 id="org282af70">Visual Studio 6</h4>
<div class="outline-text-4" id="text-org282af70">

<div id="org6a11412" class="figure">
<p><img src="./win98/visualstudio6.png" alt="visualstudio6.png" width="500" />
</p>
</div>

<p>
This is a fine piece of work. I  still remenber when I first fiddled with Visual
Basic 6, when I  didn't even know I was, in fact, creating  software and using a
programming language.
</p>

<p>
You'll find everything you need on the following link:
</p>

<p>
<a href="https://archive.org/details/en_vs6_ent">https://archive.org/details/en_vs6_ent</a>
</p>

<p>
&#x2026;however, for  the sake  of reproducibility,  I'll also  list below  the steps
needed to make Visual Studio 6 work.
</p>

<ul class="org-ul">
<li>Install Visual Studio normally using the ISO image. Use the CD key <code>873-0188911</code>.</li>
<li>Install Service Pack 6 (extract and run <code>setupsp6.exe</code>)</li>
<li>Install the KB3096896 update.</li>
<li>Open the registry (<code>Start</code> &gt; <code>Run</code> &gt; type <code>regedit</code>).</li>
<li><p>
Go  to <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\6.0\ServicePacks]</code>
and change the following keys and  values (keep <code>regedit</code> open, as you'll need
it later). Notice that <code>sp6</code> is replaced by <code>sp5</code>:
</p>

<pre class="example" id="orgb7f7726">
"latest"=dword:00000005
"sp5"=""
</pre></li>

<li>Install <code>vcpp5.exe</code>;</li>
<li><p>
Go to  the same registry  key as and restore the  keys and values.  <code>sp5</code> becomes
<code>sp6</code> again:
</p>

<pre class="example" id="org540b8e4">
"latest"=dword:00000006
"sp6"=""
</pre></li>
</ul>

<p>
Now you're ready to enjoy Visual Studio 6!
</p>
</div>
<ul class="org-ul">
<li><a id="orged5c7bf"></a>Other stuff on VS6&#x2026;<br />
<div class="outline-text-5" id="text-orged5c7bf">
<p>
I ended up doing a lot of work  by using GLUT and OpenGL, though I couldn't rely
on the  device drivers  I installed  when configuring Windows  98. For  these to
work, I had to install the MESA implementation of OpenGL for Win9x systems.
</p>

<p>
You can install a working MESA 7.5.1 driver (with OpenGL 2.1 support) from here:
<a href="https://retrosystemsrevival.blogspot.com/2020/04/opengl-21-win95.html">https://retrosystemsrevival.blogspot.com/2020/04/opengl-21-win95.html</a>
</p>

<p>
Furthermore, you'll find a working version  of binaries and source code for GLUT
3.7.6, which you can use on Visual  C++ 6.0 (complete with spec documents) here:
<a href="https://user.xmission.com/~nate/glut.html">https://user.xmission.com/~nate/glut.html</a>
</p>

<p>
Here is a timelapse of me working with some very basic OpenGL 2.1 / GLUT code in
Visual C++ 6.0.
</p>

<center>
<video controls>
<source src="./win98/w98glmusic.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
</center>

<p>
Project code on GitHub: <a href="https://github.com/luksamuk/vscpp6-glut">https://github.com/luksamuk/vscpp6-glut</a>
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org3f66dd7" class="outline-3">
<h3 id="org3f66dd7">Other useful tools</h3>
<div class="outline-text-3" id="text-org3f66dd7">
<p>
These tools are not really necessary and I didn't really use them for much work,
but they certainly come in handy every once in a while.
</p>
</div>
<div id="outline-container-org63e5948" class="outline-4">
<h4 id="org63e5948">FileZilla Client</h4>
<div class="outline-text-4" id="text-org63e5948">
<p>
Whenever I was too lazy to build a <code>.iso</code> file just to fetch a simple installer,
I just used an  FTP server and fetched the files from there.  To do that, I used
an old version of FileZilla.
</p>

<p>
You'll find it on this list: <a href="http://dk.toastednet.org/vogons/win98/">http://dk.toastednet.org/vogons/win98/</a>
</p>

<p>
You may  want to use Passive  Mode on Windows 98  if you're using a  NAT network
(which is probably the case when you're using an Oracle VirtualBox VM).
</p>
</div>
</div>
<div id="outline-container-org99829b8" class="outline-4">
<h4 id="org99829b8">Process Explorer</h4>
<div class="outline-text-4" id="text-org99829b8">
<p>
Windows 98 sometimes  crashes with processes doing weird stuff.  I know, I know,
it is an old system with many flaws.
</p>

<p>
Whenever I needed to  take a better look at how processes  were behaving, I used
an old version of Process Explorer.
</p>

<p>
You'll also find it on this list: <a href="http://dk.toastednet.org/vogons/win98/">http://dk.toastednet.org/vogons/win98/</a>
</p>
</div>
</div>
<div id="outline-container-orgd2d234d" class="outline-4">
<h4 id="orgd2d234d">AutoPatcher for Win98SE</h4>
<div class="outline-text-4" id="text-orgd2d234d">
<p>
If you're taking your  installation a bit more seriously, you  might want to run
the AutoPatcher for Windows 98 SE.
</p>

<p>
However, notice that, <b>if you like Windows 98 the way it is right now, you might
not wanna do this</b>. The default  installation for the patch will replace certain
system files, deleting  most of the system shortcuts and  changing your system's
default language.
</p>

<p>
Open the instalation file for AutoPatcher and install it.
</p>


<div id="orgaeff0b3" class="figure">
<p><img src="./win98/037.png" alt="037.png" width="500" />
</p>
</div>

<p>
It  will create  a shortcut  on your  desktop; double  click it.  You should  be
presented with an MS-DOS Prompt like the following.
</p>


<div id="orgb88f8be" class="figure">
<p><img src="./win98/038.png" alt="038.png" width="500" />
</p>
</div>

<p>
Type "A" and let it patch everything it can. Then select "I" so that it installs
all modules.
</p>

<p>
Your computer will reboot SEVERAL  TIMES while installing programs, hotfixes and
updates. Just accept everything and skip installations when they are in loop.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<h3><a href="../">Back to last page</a></h3>
</div>
</body>
</html>
